---

- hosts: testvm
  become: true
  gather_facts: false
  tasks:
   - name: install java
     apt: name=openjdk-8-jdk state=present update_cache=yes
   - name: add gpgkey
     apt_key:
      url: https://pkg.jenkins.io/debian/jenkins.io.key 
      state: present
   - name: add jenkins repository
     lineinfile:
      path: /etc/apt/sources.list.d/jenkins.list
      line: deb https://pkg.jenkins.io/debian-stable binary/
      create: yes
   - name: install jenkins
     apt:
      name: jenkins
      state: latest
      update_cache: yes
   - name: check jenkins status
     service:
      name: jenkins
      state: started
      enabled: yes
   - name: configure ufw
     ufw:
      rule: allow
      state: enabled
      port: 8080
      proto: tcp
